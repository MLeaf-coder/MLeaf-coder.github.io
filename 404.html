<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>页面重定向中</title>
    <script>
      // 单页应用 GitHub Pages 重定向脚本
      // 当用户直接访问某个路由或刷新页面时，GitHub Pages 会显示 404
      // 这个脚本会捕获当前 URL 并重定向回 index.html，同时保留路由信息

      // 获取当前 URL 路径
      const segment = 1; // 根据你的 repo 名称调整，如果是用户页面就是 0

      const location = window.location;
      const pathSegmentsToKeep =
        location.pathname.split("/").filter((p) => p.length > 0).length >
        segment
          ? segment
          : 0;

      // 重定向到首页并保留路由路径
      const redirectTo =
        location.pathname
          .split("/")
          .slice(0, pathSegmentsToKeep + 1)
          .join("/") +
        "/?/" +
        location.pathname
          .slice(1)
          .split("/")
          .slice(pathSegmentsToKeep)
          .join("/") +
        (location.search ? "&" + location.search.slice(1) : "") +
        (location.hash || "");

      // 执行重定向
      sessionStorage.setItem(
        "redirect_path",
        "/" +
          location.pathname
            .slice(1)
            .split("/")
            .slice(pathSegmentsToKeep)
            .join("/")
      );
      location.replace(redirectTo);
    </script>
  </head>
  <body>
    <h1>页面重定向中...</h1>
    <p>
      如果页面没有自动跳转，请
      <a id="redirect-link" href="/">点击这里</a> 返回首页。
    </p>

    <script>
      document.getElementById("redirect-link").setAttribute("href", "/");
    </script>
  </body>
</html>
